@if (levels$ | async; as data) {
  <div class="loyalty-grid">
    @for (level of data.levels; track level.period) {
      <div class="card"
           [class.locked]="!level.unlocked"
            [class.used]="level.unlocked && level.used">

        <div class="header">
          <strong>
            {{ level.period | titlecase }}
          </strong>
          <span>{{ level.discount }}%</span>
        </div>

        <div class="progress-bar">
          <div
            class="progress"
            [style.width.%]="level.progress"
          ></div>
        </div>

        <div class="stats">
          <span>{{ level.stats.orders }}/{{ level.required.orders }} Orders</span>
          <span>
            {{ level.stats.amount | currency:'EUR' }} /
            {{ level.required.amount | currency:'EUR' }}
          </span>
        </div>

        @if (level.available) {
          <span class="badge available">Available</span>
        }
        @else if (level.used) {
          <span class="badge used">Used this {{ level.period }}</span>
        } @else {
          <span class="badge locked">Locked</span>
        }

      </div>
    }
  </div>
}
